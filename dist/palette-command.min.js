var PaletteCommand=function(){"use strict";var e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},t=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var i=[],n=!0,r=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(i.push(o.value),!t||i.length!==t);n=!0);}catch(e){r=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw a}}return i}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();var n=0,r={isShortcut:function(e){return e.ctrlKey&&e.altKey&&"p"===e.key},navigationCallback:function(e){switch(e.key){case"ArrowDown":this.next();break;case"ArrowUp":this.prev();break;case"Enter":this.dispatch()}}};return function(){function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),this.categories={"":{}},this._id=a._sequence,this.options=Object.assign({},r,e),this._initEvent()}return i(a,null,[{key:"_sequence",get:function(){return n++}}]),i(a,[{key:"setCategory",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=t?{}:this.categories[t];e.forEach(function(e){return i[e.name]=e}),this.categories[t]=i}},{key:"removeCategory",value:function(e){e&&(!e in this.categories||delete this.categories[e])}},{key:"addToCategory",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.categories[i]||(this.categories[i]={}),Array.isArray(e)?e.forEach(function(e){return t.categories[i][e.name]=e}):this.categories[i][e.name]=e}},{key:"_findDom",value:function(){return document.getElementById("cmd-palette-"+this._id)}},{key:"_generateCommandDOM",value:function(){var i=[],n=!0,r=!1,a=void 0;try{for(var o,s=Object.entries(this.categories)[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var c=o.value,l=t(c,2),u=l[0],d=l[1],h=!0,f=!1,m=void 0;try{for(var v,y=Object.entries(d)[Symbol.iterator]();!(h=(v=y.next()).done);h=!0){var p=v.value,g=t(p,2),_=g[0],k=g[1];i.push(e({},k,{category:u,name:_,title:(u?u+": ":"")+_}))}}catch(e){f=!0,m=e}finally{try{!h&&y.return&&y.return()}finally{if(f)throw m}}}}catch(e){r=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw a}}return i.sort(function(e,t){return e.category.localeCompare(t.category)||e.title.localeCompare(t.title)}).map(function(e,t){return'\n        <li data-category="'+e.category+'" data-name="'+e.name+'"'+(0===t?" selected":"")+'>\n          <span class="title">'+e.title+'</span>\n          <span class="description">'+e.description+"</span>\n        </li>\n      "})}},{key:"_generateDom",value:function(){var e=this;document.body.insertAdjacentHTML("afterbegin",'\n      <div id="cmd-palette-'+this._id+'" class="cmd-palette'+(this.options.cssClass?" "+this.options.cssClass:"")+' cmd-palette--hide">\n        <input type="text" placeholder="Search Command">\n        <ul>\n          '+this._generateCommandDOM().join("\n")+"\n        </ul>\n      </div>\n    ");var t=this._findDom();return t.querySelector("input").addEventListener("keyup",function(t){return e.search(t.target.value)}),t}},{key:"_findOrGenerateDom",value:function(){return this._findDom()||this._generateDom()}},{key:"show",value:function(){var e=this._findOrGenerateDom();e.classList.replace("cmd-palette--hide","cmd-palette--show"),e.querySelector("input").focus()}},{key:"hide",value:function(){this._findOrGenerateDom().classList.replace("cmd-palette--show","cmd-palette--hide")}},{key:"isShow",value:function(){return this._findOrGenerateDom().classList.contains("cmd-palette--show")}},{key:"isHide",value:function(){return this._findOrGenerateDom().classList.contains("cmd-palette--hide")}},{key:"_getSelectedDomItem",value:function(){return this._findOrGenerateDom().querySelector("li[selected]")}},{key:"next",value:function(){if(!this.isHide()){var e=this._getSelectedDomItem();if(e){for(var t=e;t.nextElementSibling&&(t=t.nextElementSibling).matches(".cmd-palette-item--hide"););e.removeAttribute("selected"),t.setAttribute("selected","selected"),a._scrollTo(t)}}}},{key:"prev",value:function(){if(!this.isHide()){var e=this._getSelectedDomItem();if(e){for(var t=e;t.previousElementSibling&&(t=t.previousElementSibling).classList.contains("cmd-palette-item--hide"););e.removeAttribute("selected"),t.setAttribute("selected","selected"),a._scrollTo(t)}}}},{key:"search",value:function(e){if(!this.isHide()){e=e.trim();var t=this._findOrGenerateDom(),i=[].concat(function(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}(t.querySelectorAll("li")));e?i.forEach(function(t){a._fuzzySearch(e,t.querySelector(".title").textContent)?t.classList.remove("cmd-palette-item--hide"):t.classList.add("cmd-palette-item--hide")}):i.forEach(function(e){return e.classList.remove("cmd-palette-item--hide")}),t.querySelector("li[selected].cmd-palette-item--hide")&&this.prev(),t.querySelector("li[selected].cmd-palette-item--hide")&&this.next()}}},{key:"dispatch",value:function(){if(!this.isHide()){var e=this._findOrGenerateDom().querySelector("li[selected]:not(.cmd-palette-item--hide)");if(e){var t=e.dataset,i=t.category,n=void 0===i?"":i,r=t.name,a=this.categories[n];if(a){var o=a[r];o&&("function"==typeof o.action&&o.action(),this.hide())}}}}},{key:"_initEvent",value:function(){var e=this;this._docClickHide=function(t){t.target.matches(".cmd-palette")||t.target.closest(".cmd-palette")||e.hide()},this._docKeyPressShow=function(t){return e.options.isShortcut(t)&&e.show()},this._docKeyPressNav=function(t){e.isHide()||e.options.navigationCallback.call(e,t)},document.addEventListener("click",this._docClickHide),document.addEventListener("keypress",this._docKeyPressShow),document.addEventListener("keypress",this._docKeyPressNav)}},{key:"destroy",value:function(){document.removeEventListener("click",this._docClickHide),document.removeEventListener("keypress",this._docKeyPressShow),document.removeEventListener("keypress",this._docKeyPressNav);var e=this._findDom();e.parentNode.removeChild(e)}}],[{key:"_scrollTo",value:function(e){if(e&&e.parentElement){var t=e.clientHeight,i=e.offsetTop-t;e.parentElement.scrollTop=i-2*t}}},{key:"_fuzzySearch",value:function(e,t){var i=t.toLowerCase(),n=0,r=-1,a=void 0;for(e=e.toLowerCase();a=e[n++];)if(!~(r=i.indexOf(a,r+1)))return!1;return!0}}]),a}()}();
//# sourceMappingURL=palette-command.min.js.map
