var CommandPalette=function(){"use strict";var e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},t=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,r=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(e){r=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(r)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),n=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var i=0,r={isShortcut:function(e){return e.ctrlKey&&e.altKey&&"p"===e.key},navigationCallback:function(e){switch(e.key){case"ArrowDown":this.next();break;case"ArrowUp":this.prev();break;case"Enter":this.dispatch()}}};return function(){function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),this.contexts={"":{}},this._id=a._sequence,this.options=Object.assign({},r,e),this._initEvent()}return n(a,null,[{key:"_sequence",get:function(){return i++}}]),n(a,[{key:"setCategory",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=name?{}:this.contexts[name];e.forEach(function(e){return t[e.name]=e}),this.contexts[name]=t}},{key:"removeCategory",value:function(e){e&&(!e in this.contexts||delete this.contexts[e])}},{key:"addToCategory",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.contexts[n]||(this.contexts[n]={}),Array.isArray(e)?e.forEach(function(e){return t.contexts[n][e.name]=e}):this.contexts[n][e.name]=e}},{key:"_findDom",value:function(){return document.getElementById("cmd-palette-"+this._id)}},{key:"_generateCommandDOM",value:function(){var n=[],i=!0,r=!1,a=void 0;try{for(var o,s=Object.entries(this.contexts)[Symbol.iterator]();!(i=(o=s.next()).done);i=!0){var c=o.value,l=t(c,2),u=l[0],d=l[1];console.log(d,u);var h=!0,f=!1,m=void 0;try{for(var v,y=Object.entries(d)[Symbol.iterator]();!(h=(v=y.next()).done);h=!0){var p=v.value,g=t(p,2),k=g[0],_=g[1];n.push(e({},_,{category:u,name:k,title:(u?u+": ":"")+k}))}}catch(e){f=!0,m=e}finally{try{!h&&y.return&&y.return()}finally{if(f)throw m}}}}catch(e){r=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(r)throw a}}return n.sort(function(e,t){return e.category.localeCompare(t.category)||e.title.localeCompare(t.title)}).map(function(e,t){return'\n        <li data-category="'+e.category+'" data-name="'+e.name+'"'+(0===t?" selected":"")+'>\n          <span class="title">'+e.title+'</span>\n          <span class="description">'+e.description+"</span>\n        </li>\n      "})}},{key:"_generateDom",value:function(){var e=this;document.body.insertAdjacentHTML("afterbegin",'\n      <div id="cmd-palette-'+this._id+'" class="cmd-palette'+(this.options.cssClass?" "+this.options.cssClass:"")+' cmd-palette--hide">\n        <input type="text" placeholder="Search Command">\n        <ul>\n          '+this._generateCommandDOM().join("\n")+"\n        </ul>\n      </div>\n    ");var t=this._findDom();return t.querySelector("input").addEventListener("keyup",function(t){return e.search(t.target.value)}),t}},{key:"_findOrGenerateDom",value:function(){return this._findDom()||this._generateDom()}},{key:"show",value:function(){var e=this._findOrGenerateDom();e.classList.replace("cmd-palette--hide","cmd-palette--show"),e.querySelector("input").focus()}},{key:"hide",value:function(){this._findOrGenerateDom().classList.replace("cmd-palette--show","cmd-palette--hide")}},{key:"isShow",value:function(){return this._findOrGenerateDom().classList.contains("cmd-palette--show")}},{key:"isHide",value:function(){return this._findOrGenerateDom().classList.contains("cmd-palette--hide")}},{key:"_getSelectedDomItem",value:function(){return this._findOrGenerateDom().querySelector("li[selected]")}},{key:"next",value:function(){if(!this.isHide()){var e=this._getSelectedDomItem();if(e){for(var t=e;t.nextElementSibling&&(t=t.nextElementSibling).matches(".cmd-palette-item--hide"););e.removeAttribute("selected"),t.setAttribute("selected","selected")}}}},{key:"prev",value:function(){if(!this.isHide()){var e=this._getSelectedDomItem();if(e){for(var t=e;t.previousElementSibling&&(t=t.previousElementSibling).classList.contains("cmd-palette-item--hide"););e.removeAttribute("selected"),t.setAttribute("selected","selected")}}}},{key:"search",value:function(e){if(!this.isHide()){console.log("start search",e);var t=this._findOrGenerateDom(),n=[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(t.querySelectorAll("li")));e?n.forEach(function(t){a._fuzzySearch(e,t.querySelector(".title").textContent)?t.classList.remove("cmd-palette-item--hide"):t.classList.add("cmd-palette-item--hide")}):n.forEach(function(e){return e.classList.remove("cmd-palette-item--hide")}),t.querySelector("li[selected].cmd-palette-item--hide")&&this.prev(),t.querySelector("li[selected].cmd-palette-item--hide")&&this.next()}}},{key:"dispatch",value:function(){if(!this.isHide()){var e=this._findOrGenerateDom().querySelector("li[selected]:not(.cmd-palette-item--hide)");if(e){var t=e.dataset,n=t.category,i=void 0===n?"":n,r=t.name,a=this.contexts[i];if(a){var o=a[r];o&&"function"==typeof o.action&&o.action()}}}}},{key:"_initEvent",value:function(){var e=this;this._docClickHide=function(t){t.target.matches("#cmd-palette")||t.target.closest("#cmd-palette")||e.hide()},this._docKeyPressShow=function(t){return e.options.isShortcut(t)&&e.show()},this._docKeyPressNav=function(t){e.isHide()||e.options.navigationCallback.call(e,t)},document.addEventListener("click",this._docClickHide),document.addEventListener("keypress",this._docKeyPressShow),document.addEventListener("keypress",this._docKeyPressNav)}},{key:"destroy",value:function(){document.removeEventListener("click",this._docClickHide),document.removeEventListener("keypress",this._docKeyPressShow),document.removeEventListener("keypress",this._docKeyPressNav);var e=this._findDom();e.parentNode.removeChild(e)}}],[{key:"_fuzzySearch",value:function(e,t){var n=t.toLowerCase(),i=0,r=-1,a=void 0;for(e=e.toLowerCase();a=e[i++];)if(!~(r=n.indexOf(a,r+1)))return!1;return!0}}]),a}()}();
//# sourceMappingURL=command-palette.min.js.map
